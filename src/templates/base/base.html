{% load static tailwind_tags %}
{% load django_htmx %}
{% load i18n %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
      {% block title %}
        Datakult
      {% endblock title %}
    </title>
    <meta charset="UTF-8" />
    <meta name="description"
          content="Review and analyse the media and culture that you consume.">
    <meta name="keywords" content="Media tracker, reviews, metacritic">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="icon"
          type="image/png"
          href="{% static 'images/bookshelf.png' %}" />
    <link rel="manifest" href="{% static 'manifest.json' %}" />
    <meta name="theme-color" content="#1d232a" />
    {% tailwind_css %}
    {% htmx_script %}
    {% block extra_css %}
    {% endblock extra_css %}
    {% block head_js %}
    {% endblock head_js %}
  </head>
  <body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
    <!-- Toast container for messages -->
    <div class="toast toast-top toast-end z-50">
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} shadow-lg relative pr-12"
               role="alert">
            <span>{{ message }}</span>
            <button onclick="this.parentElement.remove()"
                    class="btn btn-ghost btn-sm btn-circle absolute top-2 right-2">{% lucide "x" %}</button>
          </div>
        {% endfor %}
      {% endif %}
    </div>
    <!-- Drawer layout: sidebar on desktop, hamburger menu on mobile -->
    <div class="drawer xl:drawer-open">
      <!-- Hidden checkbox to control drawer state -->
      <input id="sidebar-drawer" type="checkbox" class="drawer-toggle" />
      <!-- Main content area -->
      <div class="drawer-content flex flex-col">
        <!-- Minimal top navbar (mobile hamburger only) -->
        <div class="navbar bg-base-100 shadow-sm xl:hidden">
          <!-- Hamburger button (mobile only) -->
          <div class="flex-none">
            <label for="sidebar-drawer"
                   aria-label="Open sidebar"
                   class="btn btn-square btn-ghost">{% lucide "menu" %}</label>
          </div>
          <!-- Logo (mobile only) -->
          <div class="flex-1">
            <a href="{% url 'home' %}"
               class="btn btn-ghost text-xl text-primary gap-2">
              <div class="tooltip tooltip-bottom" data-tip="Icon by Freepik - Flaticon">
                <img src="{% static 'images/bookshelf.png' %}"
                     alt="Datakult logo"
                     class="w-6 h-6">
              </div>
              Datakult
            </a>
            {% if version %}<span class="text-xs text-base-content/50">v{{ version }}</span>{% endif %}
          </div>
        </div>
        <!-- Page content -->
        <div class="p-4 xl:p-12">
          {% block content %}
          {% endblock content %}
        </div>
      </div>
      <!-- Sidebar drawer -->
      <div class="drawer-side z-40">
        <label for="sidebar-drawer"
               aria-label="Close sidebar"
               class="drawer-overlay"></label>
        {% include 'partials/navigation/sidebar_nav.html' %}
      </div>
    </div>
    <script src="{% static 'js/base.js' %}"></script>
    {% block extra_js %}
    {% endblock extra_js %}
  </body>
</html>
