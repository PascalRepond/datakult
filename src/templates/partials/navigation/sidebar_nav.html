{% load i18n %}
{% load static %}
{% load media_tags %}
<ul class="menu p-4 w-80 min-h-full bg-base-200 text-base-content">
  <!-- Logo/Title at the top -->
  <li class="menu-title">
    <div class="flex justify-between items-center">
      <a href="{% url 'home' %}"
         class="flex items-center gap-3 hover:opacity-80 transition-opacity">
        <div class="tooltip tooltip-right" data-tip="Icon by Freepik - Flaticon">
          <img src="{% static 'images/bookshelf.png' %}"
               alt="Datakult logo"
               class="w-8 h-8">
        </div>
        <span class="text-xl font-bold text-primary">Datakult</span>
      </a>
      {% if version %}<span class="text-xs text-base-content/50">v{{ version }}</span>{% endif %}
    </div>
  </li>
  <!-- Main navigation -->
  <li>
    {% has_filters request as filters_active %}
    <a href="{% url 'home' %}"
       class="{% if request.resolver_match.view_name == 'home' and not filters_active %}menu-active{% endif %}">
      {% lucide "layers" %}
      {% translate "All" %}
    </a>
  </li>
  <!-- Separator -->
  <li class="menu-title mt-4">
    <span>{% translate "By status" %}</span>
  </li>
  <li>
    {% status_filter_matches request 'PLANNED' as planned_active %}
    <a href="{% url 'home' %}?status=PLANNED&sort=-updated_at"
       class="{% if planned_active %}menu-active{% endif %}">
      {% lucide "clock" %}
      {% translate "Planned" %}
    </a>
  </li>
  <li>
    {% status_filter_matches request 'IN_PROGRESS' as in_progress_active %}
    <a href="{% url 'home' %}?status=IN_PROGRESS&sort=-updated_at"
       class="{% if in_progress_active %}menu-active{% endif %}">
      {% lucide "play" %}
      {% translate "In progress" %}
    </a>
  </li>
  <li>
    {% status_filter_matches request 'PAUSED' as paused_active %}
    <a href="{% url 'home' %}?status=PAUSED&sort=-updated_at"
       class="{% if paused_active %}menu-active{% endif %}">
      {% lucide "pause" %}
      {% translate "Paused" %}
    </a>
  </li>
  <li>
    {% status_filter_matches request 'COMPLETED' 'DNF' as completed_active %}
    <a href="{% url 'home' %}?status=COMPLETED&status=DNF"
       class="{% if completed_active %}menu-active{% endif %}">
      {% lucide "circle-check" %}
      {% translate "Completed" %}
    </a>
  </li>
  <!-- Saved views -->
  {% include "partials/saved_views/saved_views_list.html" %}
  <!-- Separator for settings -->
  <li class="menu-title mt-4">
    <span>{% translate "Settings" %}</span>
  </li>
  {% if user.is_authenticated %}
    <li>
      <a href="{% url 'accounts:profile_edit' %}"
         class="{% if request.resolver_match.view_name == 'accounts:profile_edit' %}menu-active{% endif %}">
        {% lucide "circle-user" %}
        {% translate "Profile" %}
      </a>
    </li>
    <li>
      <a href="{% url 'backup_manage' %}"
         class="{% if request.resolver_match.view_name == 'backup_manage' %}menu-active{% endif %}">
        {% lucide "download" %}
        {% translate "Backups" %}
      </a>
    </li>
  {% endif %}
  <!-- Theme selector - compact dropdown -->
  <li class="dropdown w-full">
    <div tabindex="0" role="button" class="flex items-center gap-2 w-full">
      {% lucide "sun-moon" %}
      <span>{% translate "Theme" %}</span>
    </div>
    <ul tabindex="0"
        class="dropdown-content menu bg-base-100 rounded-box z-100 w-48 p-2 shadow-xl border border-base-300">
      <li>
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio"
                 name="theme-sidebar"
                 class="theme-controller radio radio-sm"
                 aria-label="{% translate "System" %}"
                 value="default" />
          <span>{% translate "System" %}</span>
        </label>
      </li>
      <li>
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio"
                 name="theme-sidebar"
                 class="theme-controller radio radio-sm"
                 aria-label="{% translate "Light" %}"
                 value="datakult-light" />
          <span>{% translate "Light" %}</span>
        </label>
      </li>
      <li>
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio"
                 name="theme-sidebar"
                 class="theme-controller radio radio-sm"
                 aria-label="{% translate "Dark" %}"
                 value="datakult-dark" />
          <span>{% translate "Dark" %}</span>
        </label>
      </li>
    </ul>
  </li>
  <!-- Authentication at the bottom -->
  <li class="mt-auto">
    {% if user.is_authenticated %}
      <form action="{% url 'logout' %}" method="post">
        {% csrf_token %}
        <button type="submit"
                role="button"
                class="flex items-center gap-2 w-full text-left cursor-pointer">
          {% lucide "log-out" %}
          {% translate "Logout" %}
        </button>
      </form>
    {% else %}
      <a href="{% url 'login' %}">
        {% lucide "log-in" %}
        {% translate "Log in" %}
      </a>
    {% endif %}
  </li>
</ul>
