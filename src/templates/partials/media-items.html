{% load i18n %}
{# This partial renders only the media items without the container #}
{% if view_mode == 'grid' %}
  {# Grid items #}
  {% for media in media_list %}
    <div class="card lg:card-side bg-base-200 shadow-md hover:shadow-lg transition-shadow">
      <figure class="basis-1/4 shrink-0 grow-0 h-full bg-base-300">
        {% if media.cover %}
          <img src="{{ media.cover.url }}"
               alt="{{ media.title }}"
               width="200"
               height="300"
               class="w-full h-full object-cover">
        {% else %}
          <div class="w-full h-full flex items-center justify-center text-base-content/30">
            {% heroicon_outline "photo" class="w-16 h-16" %}
          </div>
        {% endif %}
      </figure>
      <div class="card-body basis-3/4 p-3 h-full">
        <h3 class="card-title text-sm line-clamp-2">
          <a href="{% url 'media_edit' media.id %}" class="link link-hover">{{ media.title }}</a>
        </h3>
        <div class="text-xs space-y-1">
          {% for contributor in media.contributors.all %}
            <a href="#"
               class="link link-secondary contributor-link"
               data-contributor-id="{{ contributor.id }}"
               data-contributor-name="{{ contributor.name }}"
               hx-get="{% url 'home' %}?contributor={{ contributor.id }}"
               hx-target="#media-list"
               hx-include="#view-mode-input, #sort, #type, #status, #score, #review-from, #review-to"
               hx-push-url="true">{{ contributor.name }}</a>
            {% if not forloop.last %};{% endif %}
          {% endfor %}
          <div class="flex items-center gap-2 mt-1">
            <span class="badge badge-sm">{{ media.get_media_type_display }}</span>
            {% include "partials/status-editable.html" with status_choices=status_choices %}
          </div>
          {% include "partials/score-editable.html" %}
          {% if media.review %}
            <div id="review-cell-{{ media.id }}" class="text-sm review-text mt-2">
              {% include "partials/media-review-clamped.html" %}
            </div>
          {% endif %}
          {% if media.review_date %}
            <div class="text-xs opacity-70 mt-1">{{ media.review_date }}</div>
          {% endif %}
        </div>
      </div>
    </div>
  {% endfor %}
{% else %}
  {# Table rows #}
  {% for media in media_list %}
    <tr>
      <td>
        {% if media.cover %}
          <img src="{{ media.cover.url }}"
               alt="{% translate "Cover" %}"
               width="64"
               height="96"
               class="w-16 h-24 object-cover">
        {% else %}
          <div class="w-16 h-24 bg-gray-200 flex items-center justify-center text-xs">No cover</div>
        {% endif %}
      </td>
      <td>
        <a href="{% url 'media_edit' media.id %}" class="link link-secondary">{{ media.title }}</a>
      </td>
      <td class="max-w-xs">
        {% for contributor in media.contributors.all %}
          <a href="#"
             class="link link-secondary contributor-link"
             data-contributor-id="{{ contributor.id }}"
             data-contributor-name="{{ contributor.name }}"
             hx-get="{% url 'home' %}?contributor={{ contributor.id }}"
             hx-target="#media-list"
             hx-include="#view-mode-input, #sort, #type, #status, #score, #review-from, #review-to"
             hx-push-url="true">{{ contributor.name }}</a>
          {% if not forloop.last %};{% endif %}
        {% endfor %}
      </td>
      <td>{{ media.get_media_type_display }}</td>
      <td>
        {% include "partials/status-editable.html" with status_choices=status_choices %}
      </td>
      <td>{{ media.pub_year | default:"" }}</td>
      <td class="max-w-md">
        {% include "partials/score-editable.html" %}
        {% if media.review %}
          <div id="review-cell-{{ media.id }}" class="text-sm review-text mt-2">
            {% include "partials/media-review-clamped.html" %}
          </div>
        {% endif %}
      </td>
      <td>
        {% if media.review_date %}
          <div class="text-xs opacity-70">{{ media.review_date }}</div>
        {% endif %}
      </td>
    </tr>
  {% endfor %}
{% endif %}
